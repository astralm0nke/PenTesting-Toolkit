from Port_Scanner import PortScanner

target_ip = input("Enter target to scan for vulnerable&open ports: ")
port_range = int(input("Enter max range of ports to scan (0 to input): "))
potentially_vulnerable = input("Enter path to file with vulnerables: ") # IE this file contains potentially vulnerable IPs

portscanner = PortScanner(target_ip, port_range)
portscanner.scan()

with open(potentially_vulnerable, mode='r') as file:
    count = 0
    for banner in portscanner.banners:
        file.seek(0)
        for line in file.readlines():
            if line.strip() in banner:
                print(f'[!!] VULNERABLE BANNER: {banner} ON PORT {str(portscanner.open_ports[count])}')
        count += 1
#Count variable is what enables you to keep track of whcih port is vulnerable.
